# INTRODUCE JETPACK COMPOSE ANDROID

## 1. Introduction to Jetpack Compose

Jetpack Compose là bộ công cụ xây dựng giao diện Android theo hướng **declarative UI** (khai báo UI).
Thay vì tạo giao diện bằng XML rồi tìm `View` trong code, bạn mô tả trực tiếp UI bằng Kotlin.

### 1.1. Declarative UI là gì?

Trong cách làm cũ (XML + View system), bạn thường:

- Tạo layout XML.
- Tìm view bằng `findViewById` hoặc View Binding.
- Tự cập nhật từng view khi dữ liệu thay đổi.

Với Compose, bạn chỉ cần mô tả:

- "Khi state có giá trị A thì UI trông như thế nào".

Khi state đổi, Compose sẽ tự động tính toán và vẽ lại phần UI cần thiết (recomposition).

### 1.2. Vì sao nên học Compose?

- Viết UI nhanh hơn vì chỉ dùng Kotlin.
- Code UI dễ đọc, dễ tách nhỏ thành component.
- Quản lý state rõ ràng hơn.
- Tích hợp tốt với ViewModel, Navigation, Coroutines, Flow.
- Là hướng phát triển chính thức của Android hiện đại.

### 1.3. Từ khóa quan trọng

- `Composable`: một hàm tạo ra UI.
- `State`: dữ liệu ảnh hưởng đến giao diện.
- `Recomposition`: quá trình Compose cập nhật lại UI khi state thay đổi.

## 2. Composable Functions

## 2.1. `@Composable` là gì?

`@Composable` dùng để đánh dấu một hàm có thể vẽ UI trong Compose.

Ví dụ:

```kotlin
@Composable
fun Greeting(name: String) {
    Text(text = "Xin chào $name")
}
```

Hàm `Greeting()` không trả về `View`, nhưng Compose vẫn biết cách hiển thị UI từ hàm đó.

## 2.2. Quy tắc và cách viết Composable tốt

- Đặt tên hàm dạng PascalCase: `UserCard()`, `ProfileScreen()`.
- Mỗi Composable nên làm một việc rõ ràng.
- Ưu tiên truyền dữ liệu từ ngoài vào qua parameter.
- Hạn chế side-effect trực tiếp trong Composable.

## 2.3. Truyền parameter vào Composable

Composable có thể nhận tham số như hàm Kotlin bình thường.
Khi parameter thay đổi, UI có thể được recompose.

```kotlin
@Composable
fun Greeting(name: String) {
    Text(text = "Hello, $name!")
}
```

## 2.4. Truyền callback function vào Composable

Bạn có thể truyền hàm vào Composable để xử lý sự kiện (`onClick`, `onValueChange`, ...).

```kotlin
@Composable
fun Greeting(
    name: String,
    onClickHello: () -> Unit,
    onSendName: (String) -> Unit
) {
    Column {
        Text(text = "Hello, $name!")
        Button(onClick = onClickHello) {
            Text("Bấm để chào")
        }
        Button(onClick = { onSendName(name) }) {
            Text("Gửi tên")
        }
    }
}

@Composable
fun AppScreen() {
    Greeting(
        name = "Android",
        onClickHello = { /* xử lý click */ },
        onSendName = { value -> /* xử lý value */ }
    )
}
```

Lưu ý: nếu tham số cuối cùng là lambda, có thể dùng cú pháp trailing lambda.

## 3. `setContent {}`

## 3.1. `setContent` dùng để làm gì?

Trong `Activity`, `setContent {}` là điểm bắt đầu để gắn Compose UI lên màn hình.

Ví dụ:

```kotlin
class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            MyAppTheme {
                Greeting(name = "Compose")
            }
        }
    }
}
```

Ý nghĩa:

- `setContent {}`: khai báo UI root của Activity.
- `MyAppTheme {}`: áp dụng theme cho toàn bộ composable bên trong.
- `Greeting(...)`: composable hiển thị giao diện chính.

## 3.2. Luồng hoạt động cơ bản

1. `Activity` khởi chạy.
2. Gọi `setContent {}`.
3. Compose dựng UI ban đầu.
4. State thay đổi -> Compose recompose đúng phần cần cập nhật.

## 4. `@Preview` Annotation

## 4.1. `@Preview` là gì?

`@Preview` cho phép xem trước giao diện ngay trong Android Studio mà không cần chạy app trên máy ảo/thiết bị thật.

```kotlin
@Preview(showBackground = true)
@Composable
fun GreetingPreview() {
    Greeting(name = "Preview")
}
```

## 4.2. Một số tùy chọn `@Preview` thường dùng

- `@Preview(name = "Light Mode")`: đặt tên cho preview.
- `@Preview(showBackground = true)`: hiển thị nền để dễ nhìn UI.
- `@Preview(widthDp = 360, heightDp = 640)`: đặt kích thước preview.
- `@Preview(device = Devices.PIXEL_4)`: giả lập preview theo thiết bị.

Bạn có thể đặt nhiều `@Preview` trên cùng một hàm để kiểm tra nhiều trạng thái.

## 4.3. `@PreviewParameter`

`@PreviewParameter` dùng để truyền dữ liệu mẫu vào preview, giúp test nhiều case UI nhanh hơn.

```kotlin
class NameProvider : PreviewParameterProvider<String> {
    override val values = sequenceOf("An", "Binh", "Compose")
}

@Preview(showBackground = true)
@Composable
fun GreetingPreviewWithParam(
    @PreviewParameter(NameProvider::class) name: String
) {
    Greeting(name = name)
}
```

## 5. Modifiers

## 5.1. Modifier là gì?

`Modifier` là công cụ để tùy chỉnh cách composable hiển thị, bố trí và tương tác.
Modifier được gọi theo chuỗi (chain), từ trái sang phải.

```kotlin
Text(
    text = "Jetpack Compose",
    modifier = Modifier
        .padding(16.dp)
        .background(Color.LightGray)
        .fillMaxWidth()
)
```

## 5.2. Các nhóm modifier phổ biến

### Nhóm layout

- `padding()`
- `size()`, `width()`, `height()`
- `fillMaxWidth()`, `fillMaxSize()`
- `weight()` (dùng trong `Row`/`Column`)

### Nhóm hiển thị

- `background()`
- `border()`
- `clip()`
- `alpha()`

### Nhóm tương tác

- `clickable()`
- `combinedClickable()`
- `pointerInput()`

## 5.3. Thứ tự modifier rất quan trọng

Hai đoạn code dưới đây cho kết quả khác nhau:

```kotlin
Modifier
    .background(Color.Red)
    .padding(16.dp)
```

```kotlin
Modifier
    .padding(16.dp)
    .background(Color.Red)
```

Vì modifier áp dụng theo thứ tự, hãy sắp xếp đúng để có UI mong muốn.

## 6. Ví dụ tổng hợp cho người mới

```kotlin
class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            MaterialTheme {
                WelcomeCard(
                    name = "Android Beginner",
                    onButtonClick = { /* TODO */ }
                )
            }
        }
    }
}

@Composable
fun WelcomeCard(
    name: String,
    onButtonClick: () -> Unit
) {
    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp),
        verticalArrangement = Arrangement.Center,
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        Text(
            text = "Xin chao, $name",
            modifier = Modifier.padding(bottom = 12.dp)
        )
        Button(onClick = onButtonClick) {
            Text("Bat dau")
        }
    }
}

@Preview(showBackground = true, widthDp = 360, heightDp = 640)
@Composable
fun WelcomeCardPreview() {
    MaterialTheme {
        WelcomeCard(name = "Preview User", onButtonClick = {})
    }
}
```

## 7. Tóm tắt

- Compose giúp xây dựng UI Android bằng Kotlin, rõ ràng và hiện đại hơn XML truyền thống.
- `@Composable` là nền tảng để tạo UI component.
- `setContent {}` là nơi bắt đầu Compose UI trong `Activity`.
- `@Preview` và `@PreviewParameter` giúp kiểm tra UI nhanh, không cần chạy app.
- `Modifier` quyết định bố cục, giao diện và hành vi tương tác của composable.

Khi nắm chắc 5 phần trên, bạn đã có nền tảng tốt để học tiếp: State, ViewModel, Navigation và kiến trúc app bằng Jetpack Compose.
